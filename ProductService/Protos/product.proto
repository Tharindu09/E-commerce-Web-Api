syntax = "proto3";

option csharp_namespace = "ProductService.Grpc";

// Service for managing product operations including inventory updates and product details retrieval
service ProductService {
    //Update inventory and reserver stock
    rpc UpdateInventory(UpdateInventoryRequest) returns (UpdateInventoryResponse);
    //Get product details by product id
    rpc GetProductById (GetProductReq) returns (GetProductResponse);
    rpc ReserveStock(ReserveStockRequest)
      returns (ReserveStockResponse);

    rpc ConfirmReservation(ConfirmReservationRequest)
        returns (ConfirmReservationResponse);

    rpc CancelReservation(CancelReservationRequest)
        returns (CancelReservationResponse);
}

message UpdateInventoryRequest{
    int32 product_id = 1;
    int32 quantity_change = 2;
}

message UpdateInventoryResponse{
    bool success = 1;
    string message = 2;
    int32 new_stock =3;
}

message GetProductReq{
    int32 product_id = 1;
}

message GetProductResponse{
    string name =1 ;
    double price = 2 ;
    string category =3 ;
    int32 stock = 4;
    string image_url = 5;
 
}

message ReserveStockRequest {
  int32 order_id = 1;
  repeated Stock items = 2;
}

message Stock {
  int32 product_id = 1;
  int32 quantity = 2;
  
}

message ReserveStockResponse {
  bool success = 1;
  repeated StockReservationResult results = 2;
  string message = 3;
}
message StockReservationResult {
  int32 product_id = 1;
  bool reserved = 2;
  int32 reservation_id = 3;
}

message ConfirmReservationRequest {
  int32 reservation_id = 1;
}

message ConfirmReservationResponse {
  bool success = 1;
}

message CancelReservationRequest {
  int32 order_id = 1;
}

message CancelReservationResponse {
  bool success = 1;
}